import{c as A,u as R,r as x,o as E,n as a,j as e,X as T,W as C,R as M,p as O,i as I,q as z,h as $}from"./index-CA2xEXh_.js";import{W as q}from"./warehouse-CQFktp4z.js";import{S as U}from"./sparkles-BqjlvUoD.js";import{Z as b}from"./zap-L-fdDti7.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],j=A("package",L),B=({isOpen:y,onClose:h,onGoToMarket:N})=>{const{user:r,inventory:p,getTools:u,useItem:v,activeBuffs:w}=R(),[c,g]=x.useState("HARVESTS"),[o,k]=x.useState("NEWEST"),n=r.storageMax===1/0?1/0:r.storageMax+r.extraStorage,m=r.storageMax===1/0?0:r.storageUsed/n*100;r.storageMax!==1/0&&r.storageUsed>=n;const l=z(m),f=x.useMemo(()=>Object.values(p).filter(t=>!E(t.cropName)&&t.type==="CROP").sort((t,s)=>{if(o==="QUANTITY")return s.quantity-t.quantity;if(o==="RARITY"){const i={[a.LEGENDARY]:5,[a.EPIC]:4,[a.RARE]:3,[a.UNCOMMON]:2,[a.COMMON]:1};return i[s.rarity]-i[t.rarity]}return 0}),[p,o]),d=x.useMemo(()=>u(),[u]),S=t=>{const s=$.find(i=>i.name===t);if(s)switch(s.rarity){case a.LEGENDARY:return"ðŸ’Ž";case a.EPIC:return"â­";case a.RARE:return"ðŸŒŸ";case a.UNCOMMON:return"âœ¨";default:return"ðŸŒ¿"}return"ðŸŒ¿"};return y?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-md",onClick:h}),e.jsxs("div",{className:"relative w-full max-w-md bg-black/40 border border-white/10 rounded-3xl shadow-2xl overflow-hidden backdrop-blur-xl animate-in fade-in zoom-in-95 duration-200 flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-5 bg-gradient-to-r from-amber-500/80 to-yellow-600/80 backdrop-blur-md border-b border-white/10",children:[e.jsxs("h2",{className:"text-xl font-black tracking-widest uppercase text-white drop-shadow-sm flex items-center gap-2",children:[e.jsx(q,{size:20})," WAREHOUSE"]}),e.jsx("button",{onClick:h,className:"bg-black/20 p-2 rounded-full hover:bg-black/40 text-white transition-colors",children:e.jsx(T,{size:20})})]}),e.jsx("div",{className:"px-5 pt-4",children:e.jsxs("div",{className:"bg-black/40 rounded-2xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{size:14,className:l.text}),e.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wide",children:"Storage"})]}),e.jsxs("span",{className:`text-sm font-black ${l.text}`,children:[r.storageUsed," / ",n===1/0?"âˆž":n]})]}),n!==1/0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full h-3 bg-gray-800/50 rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:`h-full transition-all duration-500 ${l.bar}`,style:{width:`${Math.min(m,100)}%`}})}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:`text-[10px] font-bold uppercase ${l.text}`,children:l.status==="critical"?"STORAGE CRITICAL!":l.status==="warning"?"Storage Low":"Storage Available"}),e.jsxs("span",{className:`text-[10px] font-mono ${l.text}`,children:[m.toFixed(1),"%"]})]})]}):e.jsxs("div",{className:"text-green-400 text-xs font-bold flex items-center gap-1",children:[e.jsx(U,{size:12})," Unlimited Storage (VIP)"]})]})}),e.jsx("div",{className:"px-5 pt-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>g("HARVESTS"),className:`flex-1 py-2.5 rounded-xl font-black uppercase text-xs tracking-wider transition-all flex items-center justify-center gap-2 ${c==="HARVESTS"?"bg-amber-500 text-black":"bg-white/5 text-gray-400 hover:bg-white/10"}`,children:[e.jsx(C,{size:14})," Harvests"]}),e.jsxs("button",{onClick:()=>g("TOOLS"),className:`flex-1 py-2.5 rounded-xl font-black uppercase text-xs tracking-wider transition-all flex items-center justify-center gap-2 ${c==="TOOLS"?"bg-amber-500 text-black":"bg-white/5 text-gray-400 hover:bg-white/10"}`,children:[e.jsx(b,{size:14})," Tools",d.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] px-1.5 rounded-full",children:d.length})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto scrollbar-hide p-5",children:[c==="HARVESTS"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-1",children:["NEWEST","QUANTITY","RARITY"].map(t=>e.jsx("button",{onClick:()=>k(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all border ${o===t?"bg-amber-500 border-amber-400 text-black":"bg-white/5 border-white/10 text-gray-400 hover:bg-white/10"}`,children:t},t))}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[f.map((t,s)=>{const i=M[t.rarity];return e.jsxs("div",{className:"aspect-square bg-black/40 rounded-xl flex flex-col items-center justify-center relative shadow-lg transition-transform hover:scale-105",style:{border:`2px solid ${i}`},children:[e.jsx("div",{className:"text-3xl drop-shadow-md",children:S(t.cropName)}),e.jsxs("div",{className:"absolute bottom-1 right-1 bg-black/80 text-[10px] px-1.5 py-0.5 rounded-md text-white font-bold border border-white/10",children:["x",t.quantity]}),e.jsx("div",{className:"absolute top-1 left-1 w-2 h-2 rounded-full",style:{backgroundColor:i}})]},s)}),f.length===0&&e.jsxs("div",{className:"col-span-4 py-12 text-center",children:[e.jsx(j,{size:48,className:"mx-auto text-gray-600 mb-3"}),e.jsx("div",{className:"text-gray-500 italic",children:"Barn is empty"}),e.jsx("div",{className:"text-gray-600 text-xs mt-1",children:"Plant some crops to get started!"})]})]})]}),c==="TOOLS"&&e.jsxs("div",{className:"space-y-3",children:[d.map(t=>{O[t.id];const s=(w[t.effect]||0)>Date.now();return e.jsx("div",{className:`bg-black/40 rounded-xl p-4 border transition-all ${s?"border-green-500/50 bg-green-500/10":"border-white/5"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-xl flex items-center justify-center text-3xl ${s?"bg-green-500/20":"bg-white/10"}`,children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-black text-white uppercase text-sm",children:t.name}),s&&e.jsx("span",{className:"bg-green-500 text-black text-[9px] px-2 py-0.5 rounded-full font-bold",children:"ACTIVE"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"text-xs font-bold text-amber-400",children:["x",t.quantity]}),s?e.jsxs("span",{className:"text-[10px] text-green-400 flex items-center gap-1",children:[e.jsx(b,{size:10})," Active"]}):e.jsx("span",{className:"text-[10px] text-gray-500",children:"Tap to activate"})]})]}),e.jsx("button",{onClick:()=>{!s&&t.quantity>0&&v(t.id)},disabled:s||t.quantity<=0,className:`px-4 py-2 rounded-lg font-black uppercase text-xs transition-all ${s?"bg-gray-700 text-gray-500 cursor-not-allowed":t.quantity>0?"bg-gradient-to-r from-green-500 to-emerald-500 text-white hover:brightness-110":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:s?"Active":t.quantity<=0?"Empty":"Use"})]})},t.id)}),d.length===0&&e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(b,{size:48,className:"mx-auto text-gray-600 mb-3"}),e.jsx("div",{className:"text-gray-500 italic",children:"No tools in inventory"}),e.jsx("div",{className:"text-gray-600 text-xs mt-1",children:"Buy consumables from the Market!"})]})]})]}),e.jsx("div",{className:"p-4 bg-black/20 border-t border-white/5 backdrop-blur-md",children:e.jsx(I,{variant:"yellow",className:"w-full",onClick:N,children:"Go to Market"})})]})]}):null};export{B as BarnModal};
